<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1 Solr基础介绍 | 超级开发工程师</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/avatar.png">
    <meta name="description" content="种一棵树最好的时间是十年前,其次是现在。">
    
    <link rel="preload" href="/assets/css/0.styles.7a6eb978.css" as="style"><link rel="preload" href="/assets/js/app.c8dcfb20.js" as="script"><link rel="preload" href="/assets/js/2.b454a092.js" as="script"><link rel="preload" href="/assets/js/13.28c3b946.js" as="script"><link rel="prefetch" href="/assets/js/10.9e5ae3e5.js"><link rel="prefetch" href="/assets/js/11.b39e5cd7.js"><link rel="prefetch" href="/assets/js/12.ba13825d.js"><link rel="prefetch" href="/assets/js/14.e8b30ec8.js"><link rel="prefetch" href="/assets/js/15.c7a6ff8b.js"><link rel="prefetch" href="/assets/js/16.f2a9d223.js"><link rel="prefetch" href="/assets/js/17.f8899822.js"><link rel="prefetch" href="/assets/js/18.203f2eef.js"><link rel="prefetch" href="/assets/js/19.b6819623.js"><link rel="prefetch" href="/assets/js/20.30c82cff.js"><link rel="prefetch" href="/assets/js/3.eba60fea.js"><link rel="prefetch" href="/assets/js/4.46286b97.js"><link rel="prefetch" href="/assets/js/5.9df3379b.js"><link rel="prefetch" href="/assets/js/6.8f3b3055.js"><link rel="prefetch" href="/assets/js/7.2efe2123.js"><link rel="prefetch" href="/assets/js/8.c0add51c.js"><link rel="prefetch" href="/assets/js/9.c8ce3283.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a6eb978.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.png" alt="超级开发工程师" class="logo"> <span class="site-name can-hide">超级开发工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/Git.html" class="nav-link">
  框架
</a></li><li class="dropdown-item"><!----> <a href="/source/集合-ArrayList.html" class="nav-link">
  源码
</a></li><li class="dropdown-item"><!----> <a href="/database/MySQL.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/data_structure/数据结构-队列.html" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><a href="/miscellaneous/Java阅读问题汇总.html" class="nav-link">
  技术杂谈
</a></div><div class="nav-item"><a href="https://github.com/bean1006" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/Git.html" class="nav-link">
  框架
</a></li><li class="dropdown-item"><!----> <a href="/source/集合-ArrayList.html" class="nav-link">
  源码
</a></li><li class="dropdown-item"><!----> <a href="/database/MySQL.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/data_structure/数据结构-队列.html" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><a href="/miscellaneous/Java阅读问题汇总.html" class="nav-link">
  技术杂谈
</a></div><div class="nav-item"><a href="https://github.com/bean1006" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>版本控制</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>搜索引擎</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/Solr.html" aria-current="page" class="active sidebar-link">Solr</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-1-什么是solr" class="sidebar-link">1.1 什么是Solr</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-2-solr的优缺点" class="sidebar-link">1.2 Solr的优缺点</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-3-使用版本" class="sidebar-link">1.3 使用版本</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-4-安装" class="sidebar-link">1.4 安装</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-5-目录布局" class="sidebar-link">1.5 目录布局</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_1-6-常用命令" class="sidebar-link">1.6 常用命令</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_2-1-什么是core" class="sidebar-link">2.1 什么是core</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_2-2-core的创建" class="sidebar-link">2.2 core的创建</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_2-3-core的删除" class="sidebar-link">2.3 core的删除</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_3-1-什么是schema" class="sidebar-link">3.1 什么是schema</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_3-2-schema配置" class="sidebar-link">3.2 schema配置</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_3-3-ik分词器配置" class="sidebar-link">3.3 ik分词器配置</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_4-1-概述" class="sidebar-link">4.1 概述</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_4-2-使用方式" class="sidebar-link">4.2 使用方式</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_5-1-根据文件导入数据" class="sidebar-link">5.1 根据文件导入数据</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_5-2-添加-更新文档" class="sidebar-link">5.2 添加/更新文档</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_5-3-删除文档" class="sidebar-link">5.3 删除文档</a></li><li class="sidebar-sub-header"><a href="/framework/Solr.html#_5-4-查询数据" class="sidebar-link">5.4 查询数据</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CICD</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-solr基础介绍"><a href="#_1-solr基础介绍" class="header-anchor">#</a> 1 Solr基础介绍</h1> <h2 id="_1-1-什么是solr"><a href="#_1-1-什么是solr" class="header-anchor">#</a> 1.1 什么是Solr</h2> <p>Solr是Apache开源的、基于Lucene的Java Api的封装,是一款成熟稳定的搜索引擎。</p> <h2 id="_1-2-solr的优缺点"><a href="#_1-2-solr的优缺点" class="header-anchor">#</a> 1.2 Solr的优缺点</h2> <p>优点:</p> <ol><li><p>大量的用户群体与成熟的社区</p></li> <li><p>支持多种格式索引,例如HTML、CSV、JSON、XML等</p></li> <li><p>诞生于与2004年,多年的沉淀使得Solr成熟、稳定</p></li> <li><p><strong>如果不考虑建索引的同时进行查询,查询速度更快</strong>,像我目前接手的法律查询软件,法律的录入不是十分频繁,那么用Solr就会比较合适</p></li></ol> <p>缺点:</p> <ol><li>在建立索引时,搜索效率不高,例如淘宝热卖那种需要实时更新索引的项目,Solr就显得有点力不从心了</li></ol> <h2 id="_1-3-使用版本"><a href="#_1-3-使用版本" class="header-anchor">#</a> 1.3 使用版本</h2> <ol><li>JDK-1.8</li> <li>Solr-7.7.3(未使用最新版是因为公司用的不是最新版,然后核心知识都大同小异,后续会再看8.x有什么更新)</li> <li>ik分词器-7.x</li></ol> <h2 id="_1-4-安装"><a href="#_1-4-安装" class="header-anchor">#</a> 1.4 安装</h2> <ol><li><p>下载安装包 <a href="https://mirrors.bfsu.edu.cn/apache/lucene/solr/7.7.3/solr-7.7.3.tgz" target="_blank" rel="noopener noreferrer"><strong>https://mirrors.bfsu.edu.cn/apache/lucene/solr/7.7.3/solr-7.7.3.tgz</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>到安装路径下解压 tar -zxvf solr-7.7.3.tgz(tgz相当于是tar.gz)</p></li></ol> <h2 id="_1-5-目录布局"><a href="#_1-5-目录布局" class="header-anchor">#</a> 1.5 目录布局</h2> <table><thead><tr><th style="text-align:center;">目录</th> <th style="text-align:center;">介绍</th></tr></thead> <tbody><tr><td style="text-align:center;">bin</td> <td style="text-align:center;">包含启动等一些重要脚本</td></tr> <tr><td style="text-align:center;">contrib</td> <td style="text-align:center;">Solr的附加插件</td></tr> <tr><td style="text-align:center;">dist</td> <td style="text-align:center;">Solr的jar包</td></tr> <tr><td style="text-align:center;">docs</td> <td style="text-align:center;">Solr的在线文档</td></tr> <tr><td style="text-align:center;">example</td> <td style="text-align:center;">演示案例</td></tr> <tr><td style="text-align:center;">licenses</td> <td style="text-align:center;">Solr使用的第三方库的许可证</td></tr> <tr><td style="text-align:center;">server</td> <td style="text-align:center;">Solr的核心应用,包含管理UI界面等</td></tr></tbody></table> <h2 id="_1-6-常用命令"><a href="#_1-6-常用命令" class="header-anchor">#</a> 1.6 常用命令</h2> <p>bin/solr start  启动(macOS与Linux均以下述方式启动,Windows需要在加个.cmd如:<strong>bin/solr.cmd start</strong>)</p> <p>bin/solr stop 关闭</p> <p>bin/solr restart 重启</p> <p>bin/solr status 查看状态</p> <p>Solr有单机运行与集群运行两种方式,本文主要以单机运行为主了,默认启动端口为8983,若想指定端口可以在后面加上 -p 参数,如</p> <ul><li>bin/solr start -p 端口号</li> <li>bin/solr restart  -p 端口号</li></ul> <p>此时可以在浏览器输入 http://localhost:8983/ 来打开admin UI界面:</p> <p><img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207140119.png" alt="WechatIMG3302"></p> <h1 id="_2-core配置"><a href="#_2-core配置" class="header-anchor">#</a> 2 core配置</h1> <h2 id="_2-1-什么是core"><a href="#_2-1-什么是core" class="header-anchor">#</a> 2.1 什么是core</h2> <p>是一个Lucene实例,其中包含Solr所有的配置文件,我们需要创建一个core来完成索引与分析等操作</p> <p>一个Solr可以有多个core,如果需要core之间也是可以互相通信的</p> <h2 id="_2-2-core的创建"><a href="#_2-2-core的创建" class="header-anchor">#</a> 2.2 core的创建</h2> <ol><li><p>create命令创建</p> <p>./solr create -c  new_core1</p></li> <li><p>admin UI上直接创建</p> <p>a. 此步执行之前,需要先将solr的默认配置文件夹复制到solr/server/solr/下,并重命名(下例中取名为new_core2),参考命令: cp -r ~/Library/solr-7.7.3/server/solr/configsets/_default/conf/  ~/Library/solr-7.7.3/server/solr/new_core2/
b. 重启
c. <img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207155125.png" alt="image-20210207155125070" style="zoom:50%;"></p></li></ol> <p>注意项:</p> <ol><li>用第一种方法创建,会自动在server/solr下创建一个名为new_core1的core文件夹,里面有着所需的配置文件(server/solr也称solr_home)</li> <li>第二种方式创建相当于我们手动创建了core文件夹</li> <li>core还有其他创建方式,但这两种比较常见</li></ol> <h2 id="_2-3-core的删除"><a href="#_2-3-core的删除" class="header-anchor">#</a> 2.3 core的删除</h2> <p>​	./solr delete -c my_core</p> <h1 id="_3-schema配置"><a href="#_3-schema配置" class="header-anchor">#</a> 3 schema配置</h1> <h2 id="_3-1-什么是schema"><a href="#_3-1-什么是schema" class="header-anchor">#</a> 3.1 什么是schema</h2> <p>在讲schema之前需要先了解一个概念   <strong>index(索引)</strong></p> <p>这里的索引和数据库中的索引不同,可以简单理解为Solr中的一张表,与Elasticsearch中的索引概念类似,举个例子:</p> <p>我有学生表和课程表,我有一条很频繁的查询是某某学生某某课程考了多少分,那我就需要从数据库把这两张表的内容查询出来处理完后再传回客户端,而solr会把这两张表中需要的字段提取出来,存放到solr中去,而存放的数据结构就是索引,这相当于是数据库里的一张表</p> <p>而schema就是Solr如何建立索引的说明书,例如字段的数据类型以及分词方式等</p> <h2 id="_3-2-schema配置"><a href="#_3-2-schema配置" class="header-anchor">#</a> 3.2 schema配置</h2> <p>在Solr5.5之前的配置文件叫schema.xml,这些需要手动配置,密密麻麻的XML看着还挺头疼的,之后出现了的配置文件叫做managed-schema,他的配置方式是使用schemaAPI来实时配置,并且配置之后无须重启即可生效,更加适合生产环境,也更好操作</p> <p>常见的配置内容:</p> <ol><li><p>field:  相当于Java类的属性字段,可以给他配上其他属性,比如是否需要显示,是否可以用做索引字段等,有明确的定义的普通字段
<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207171043.png" alt="image-20210207171043365">
a. name: 查询时字段
b. type: 字段类型
c. indexed: 是否为索引字段
d. stored: 是否存储
e. multiValued: 是否允许多值</p></li> <li><p>dynamicField: 与field类似,是未明确定义名字的字段,常用属性与field了类似</p> <p><img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207172527.png" alt="image-20210207172527096"></p></li> <li><p>copyField:</p> <ul><li>可以将field字段拷贝到其他字段</li> <li>可以将dynamicField字段拷贝到其他字段</li> <li>可以将多个field字段拷贝到多值字段</li> <li>可以将多个dynamicField字段拷贝到多值字段</li> <li><img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207172637.png" alt="image-20210207172637955"></li></ul></li> <li><p>fieldType: 一般用来定义分词器,然后让field/dynamicField通过type引用</p> <p><img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210207172800.png" alt="image-20210207172800274"></p></li> <li><p>analyzer: fieldType的子属性,常用于设置分词器</p></li></ol> <h2 id="_3-3-ik分词器配置"><a href="#_3-3-ik分词器配置" class="header-anchor">#</a> 3.3 ik分词器配置</h2> <p>步骤:</p> <ol><li><p>下载jar包:https://search.maven.org/search?q=com.github.magese	<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210219085443.png" alt="image-20210219085443741"></p></li> <li><p>把jar包放置到(以我的为例)solr-7.7.3/server/solr-webapp/webapp/WEB-INF/lib下</p></li> <li><p>到solr-7.7.3/server/solr/new_core/managed-schema下最底下粘贴以下内容:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>  <span class="token comment">&lt;!-- ik分词器 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldType</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text_ik<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.TextField<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tokenizer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.wltea.analyzer.lucene.IKTokenizerFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">useSmart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">conf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ik.conf<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.LowerCaseFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>analyzer</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>query<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tokenizer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.wltea.analyzer.lucene.IKTokenizerFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">useSmart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">conf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ik.conf<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.LowerCaseFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>analyzer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldType</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>重启Solr</p></li> <li><p>测试分词器	<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210219090639.png" alt="image-20210219090639925"></p></li></ol> <p>Field Value(Index)与Field Value(Query)是Solr在索引时与在查询时会怎么处理数据,可以根据这两个来帮助设计分析器、分词器和过滤器(本文采用了ik分词器,上述三者ik分词器已经自己设计好了,关于这三者具体内容见下文)</p> <h1 id="_4-分析器、分词器、过滤器"><a href="#_4-分析器、分词器、过滤器" class="header-anchor">#</a> 4 分析器、分词器、过滤器</h1> <p>Solr主要通过分析器(Analyzer)、标记器(Tokenizers)、过滤器(Filter)来分解和处理文本。</p> <p>在介绍之前,先讲述一个概念文档(Document),之前说index相当于数据库里的一张表,而文档就可以理解为表里的一条数据。</p> <h2 id="_4-1-概述"><a href="#_4-1-概述" class="header-anchor">#</a> 4.1 概述</h2> <p>当对一个文档进行索引时,每个field的数据都会经过分析,分词过滤等操作,例如,将一句话分词若干个单词和词组,然后去掉空格与语气词等多余的词以及进行同义词替换等,例如:</p> <p>what a beautiful girl,在这里what和a这样的词以及空格会被去掉,最终的处理结果为beautiful和girl或者是beautiful girl</p> <p>除了索引会做这些工作,查询时也会做这些工作,并且为了保证索引与查询可以正确匹配,二者的处理规则往往也是相同的,例如:</p> <p>ABCD索引分词为AB CD,查询时分词为A BCD,这样匹配的结果就为0</p> <p>analyzer包含着两个部分,Tokenizers与Filter。Tokenizers就是将句子拆分成单个词,而Filter就是对分词的结果中比如中文里的&quot;的&quot;、&quot;呀&quot;、&quot;啊&quot;,英文里的&quot;am&quot;、&quot;is&quot;、&quot;are&quot;这类对句子主体意思关系不大的词去掉</p> <p>solr有自带了一些分词器,如果你需要使用中文分词器就需要自己配置,参考3.3</p> <h2 id="_4-2-使用方式"><a href="#_4-2-使用方式" class="header-anchor">#</a> 4.2 使用方式</h2> <p>analyzer为fieldType下的一个子元素,主要作用是检查字段的文本并生成令牌流</p> <p>最简单的使用方式如下:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldType</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nametext<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.TextField<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.lucene.analysis.core.WhitespaceAnalyzer<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldType</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中analyzer通过一个全限定Java类名引入,且命名的类必须继承自org.apache.lucene.analysis.Analyzer</p> <p>对于简单的文章,这样一个分析器类就足够完成任务,但是通常情况下是需要更为复杂的分析</p> <p>Solr提供了大量的Tokenizers与Filter来协助分析,例如:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldType</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nametext<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.TextField<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tokenizer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.StandardTokenizerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.StandardFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.LowerCaseFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.StopFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.EnglishPorterFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>analyzer</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldType</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>org.apache.solr.analysis 包中的类可以在这里用简写的 solr. 前缀来代替</p> <p>上述中,analyzer未使用指定的分析器类,而用许多类组合到一起,成为该字段的分析器,任何使用&quot;nametext&quot;fieldType字段进行索引或查询时,都会经过从StandardTokenizerFactory到EnglishPorterFilterFactory的过滤</p> <p>分析发生在两种情况下:分别是索引时与查询时</p> <p>在索引时:当一个字段被创建时，分析得到的令牌流将被添加到一个索引中，并为该字段定义一组术语（包括位置、大小等）。</p> <p>在查询时:分析正在搜索的值，并将结果的条件与存储在字段索引中的条件进行匹配。</p> <p>如果想要在不同阶段使用不同的分析器,可以指定type属性:如下:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldType</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nametext<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.TextField<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tokenizer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.StandardTokenizerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.LowerCaseFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.KeepWordFilterFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">words</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keepwords.txt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.SynonymFilterFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">synonyms</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>syns.txt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>analyzer</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>analyzer</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>query<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tokenizer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.StandardTokenizerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>solr.LowerCaseFilterFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>analyzer</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldType</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>在索引时,文本被标记化,并设置为小写,未列在keepwords.txt中的会被丢弃,保留下来的会根据syns.txt进行同义词替换</p> <p>在查询时,就只是将文本标记后设置为小写</p> <h1 id="_5-solr的使用"><a href="#_5-solr的使用" class="header-anchor">#</a> 5 Solr的使用</h1> <h2 id="_5-1-根据文件导入数据"><a href="#_5-1-根据文件导入数据" class="header-anchor">#</a> 5.1 根据文件导入数据</h2> <p>Solr可以导入多种格式的文件来作为index,在solr-7.7.3/example/exampledocs中有各个格式的测试案例,本文随机采用一种演示</p> <p>可以通过bin目录下的post命令导入index</p> <p>输入 bin/post -h 可查看具体使用方式</p> <p>示例: bin/post -c 导入的核心名 导入的文件(可多个)</p> <p>下面演示一下往new_core里导入book.csv与book.json文件:</p> <ol><li>bin/post -c new_core example/exampledocs/books.csv example/exampledocs/books.json</li> <li>查看演示数据
<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210219095506.png" alt="image-20210219095506274"></li></ol> <h2 id="_5-2-添加-更新文档"><a href="#_5-2-添加-更新文档" class="header-anchor">#</a> 5.2 添加/更新文档</h2> <p>添加/更新内容(根据是否有id判断为添加还是更新操作):	<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210219102710.png" alt="image-20210219102710466"></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;1234567890&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cat&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;book&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;BeanChan is a handsome man&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">799</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;inStock&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;BeanChan&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;series_t&quot;</span><span class="token operator">:</span><span class="token string">&quot;A man has a pretty face&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sequence_i&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;genre_s&quot;</span><span class="token operator">:</span><span class="token string">&quot;fantasy&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-3-删除文档"><a href="#_5-3-删除文档" class="header-anchor">#</a> 5.3 删除文档</h2> <p>需基于XML方式<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210220093542.png" alt="image-20210220093541899"></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--删除所有索引--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span><span class="token punctuation">&gt;</span></span>
　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>query</span><span class="token punctuation">&gt;</span></span>*:*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>query</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>commit</span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- 根据 id 进行删除--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span><span class="token punctuation">&gt;</span></span>
　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>commit</span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-4-查询数据"><a href="#_5-4-查询数据" class="header-anchor">#</a> 5.4 查询数据</h2> <table><thead><tr><th style="text-align:center;">参数</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:center;">q</td> <td style="text-align:center;">主要查询参数</td></tr> <tr><td style="text-align:center;">fq</td> <td style="text-align:center;">过滤器查询参数</td></tr> <tr><td style="text-align:center;">start</td> <td style="text-align:center;">起始页</td></tr> <tr><td style="text-align:center;">rows</td> <td style="text-align:center;">查询行数</td></tr> <tr><td style="text-align:center;">sort</td> <td style="text-align:center;">排序方式</td></tr> <tr><td style="text-align:center;">fl</td> <td style="text-align:center;">结果集字段列表</td></tr> <tr><td style="text-align:center;">wt</td> <td style="text-align:center;">展示格式(下图以csv格式展示)</td></tr></tbody></table> <p>下图为例:
<img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210220101639.png" alt="image-20210220101639220"></p> <h1 id="_6-整合springboot"><a href="#_6-整合springboot" class="header-anchor">#</a> 6 整合springboot</h1> <ol><li><p>引入pom依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-data-solr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>配置yml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">solr</span><span class="token punctuation">:</span>
      <span class="token key atrule">host</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>8983/solr
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>配置entity</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span><span class="token class-name">Field</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">SolrDocument</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Classname SolrEntity
 * @Author ChenBin
 * @Description
 * @CreateDate 2021/2/20 2:00 PM
 */</span>
<span class="token annotation punctuation">@SolrDocument</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;new_core&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SolrEntity</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Field</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li> <li><p>配置dao</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">SolrEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">SolrCrudRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Classname solaDao
 * @Author ChenBin
 * @Description
 * @CreateDate 2021/2/20 3:25 PM
 */</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SolrDao</span> <span class="token keyword">extends</span> <span class="token class-name">SolrCrudRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SolrEntity</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p>配置service及其实现类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">SolrEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrServerException</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @InterfaceName ISolrService
 * @Author ChenBin
 * @Description
 * @CreateDate 2021/2/20 3:33 PM
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ISolrService</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SolrEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">quertList</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">SolrServerException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">SolrDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">SolrEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ISolrService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrQuery</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrServerException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span>response<span class="token punctuation">.</span></span><span class="token class-name">QueryResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>common<span class="token punctuation">.</span></span><span class="token class-name">SolrDocument</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>common<span class="token punctuation">.</span></span><span class="token class-name">SolrDocumentList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Classname ISolrServiceImpl
 * @Author ChenBin
 * @Description
 * @CreateDate 2021/2/20 3:34 PM
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ISolrServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">ISolrService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">SolrDao</span> solrDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">SolrClient</span> solrClient<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SolrEntity</span> solrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SolrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;阿姆斯特朗回旋加速喷气式阿姆斯特朗炮制作图纸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>solrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SolrEntity</span> solrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SolrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;阿姆斯特朗回旋加速喷气式阿姆斯特朗炮使用手册&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        solrDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>solrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        solrDao<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SolrEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">quertList</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">SolrServerException</span> <span class="token punctuation">{</span>

        <span class="token class-name">SolrQuery</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SolrQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置查询条件</span>
        query<span class="token punctuation">.</span><span class="token function">setQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name:阿姆斯特朗&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//按照时间排序</span>
        <span class="token comment">// query.addSort(&quot;create_time&quot;, SolrQuery.ORDER.desc);</span>

        <span class="token comment">//开始页</span>
        query<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//一页显示多少条</span>
        query<span class="token punctuation">.</span><span class="token function">setRows</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//开启高亮</span>
        <span class="token comment">//query.setHighlight(true);</span>
        <span class="token comment">//设置高亮字段</span>
        <span class="token comment">//query.addHighlightField(&quot;demoName&quot;);</span>
        <span class="token comment">//前缀</span>
        <span class="token comment">//query.setHighlightSimplePre(&quot;&lt;font color='red'&gt;&quot;);</span>
        <span class="token comment">//后缀</span>
        <span class="token comment">//query.setHighlightSimplePost(&quot;&lt;/font&gt;&quot;);</span>
        <span class="token comment">//执行查找</span>
        <span class="token class-name">QueryResponse</span> response <span class="token operator">=</span> solrClient<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&quot;new_core&quot;</span><span class="token punctuation">,</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SolrDocumentList</span> results <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取查询到的数据总量</span>
        <span class="token keyword">long</span> numFound <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">getNumFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numFound <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//如果小于0，表示未查询到任何数据，返回null</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SolrEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//遍历结果集</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SolrDocument</span> doc <span class="token operator">:</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//得到每条数据的map集合</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getFieldValueMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//添加到list</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> key <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;KEY:&quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot;,VALUE:&quot;</span> <span class="token operator">+</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">SolrEntity</span> demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SolrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                demo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                demo<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> list<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br></div></div></li> <li><p>配置Controller</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">SolrEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">beanchan<span class="token punctuation">.</span>cn<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ISolrService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrServerException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Classname searchController
 * @Author ChenBin
 * @Description
 * @CreateDate 2021/2/20 10:57 AM
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">ISolrService</span> solrService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 新增
     *
     * @return flag
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        solrService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        solrService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;delete&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        solrService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;queryList&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queryList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SolrEntity</span><span class="token punctuation">&gt;</span></span> solrEntities <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            solrEntities <span class="token operator">=</span> solrService<span class="token punctuation">.</span><span class="token function">quertList</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">SolrServerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>solrEntities <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> solrEntities<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;empty&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div></li> <li><p>测试还请自行实验,下图简单展示一下</p> <p><img src="https://beanchan-image.oss-cn-guangzhou.aliyuncs.com/20210220164722.png" alt="image-20210220164722459"></p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/NoSQL基本知识.html" class="prev">
        NoSQL基本知识
      </a></span> <span class="next"><a href="/framework/Jenkins.html">
        Jenkins
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c8dcfb20.js" defer></script><script src="/assets/js/2.b454a092.js" defer></script><script src="/assets/js/13.28c3b946.js" defer></script>
  </body>
</html>
